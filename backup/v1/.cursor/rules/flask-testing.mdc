---
name: flask-testing.mdc
description: Flask testing rules for Cursor IDE
globs:
  - "**/tests/**"
  - "**/*test*.py"
---

# Flask Testing Rules

## Test Structure
- Use pytest as testing framework
- Organize tests in `tests/` directory
- Use fixtures for common test data and setup
- Name test files with `test_` prefix
- Name test functions with `test_` prefix

## Fixtures
- Use `conftest.py` for shared fixtures
- Create fixtures for temporary directories and files
- Use pytest fixtures for app context
- Clean up resources in fixture teardown

## Test Organization
- Group related tests in test classes or modules
- Use descriptive test names
- Test one thing per test function
- Use parametrized tests for testing multiple scenarios

## Mocking
- Mock external API calls
- Mock file system operations when appropriate
- Mock slow operations for faster tests
- Use `pytest-mock` for advanced mocking

## Test Coverage
- Aim for high test coverage (>80%)
- Test happy paths and error cases
- Test edge cases and boundary conditions
- Use `pytest-cov` for coverage reports

## Test Data
- Use minimal test data fixtures
- Create reusable test data factories
- Use faker for generating test data when needed
- Keep test data isolated and independent

## Integration Tests
- Test API endpoints with test client
- Test database operations with test database
- Test file operations with temporary directories
- Test error handling and edge cases

## Running Tests
```bash
# Run all tests
pytest tests/ -v

# Run with coverage
pytest tests/ -v --cov=src --cov-report=html

# Run specific test file
pytest tests/test_metadata.py -v

# Run specific test
pytest tests/test_metadata.py::test_extract_epub_metadata -v
```
